<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pagina Protetta</title>
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body>
    <h1>Benvenuto!</h1>
    <p id="message">Devi accedere per vedere il contenuto.</p>
    <button onclick="netlifyIdentity.open()">Accedi</button>
    <button onclick="netlifyIdentity.logout()">Esci</button>
    
    <script>
        netlifyIdentity.on('init', user => {
            if (!user) {
                window.location.href = "/login/";
            } else {
                document.getElementById('message').innerText = `Ciao, ${user.user_metadata.full_name}! Contenuto protetto visibile.`;
            }
        });
        
        netlifyIdentity.on('logout', () => {
            window.location.href = "/login/";
        });
    </script>
</body>
</html>
